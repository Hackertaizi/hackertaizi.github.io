<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hackertaizi.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Hive 基本语法一、DDL1. 数据库操作1.1 创建数据库语法格式： 12345CREATE [REMOTE] (DATABASE|SCHEMA) [IF NOT EXISTS] database_name  [COMMENT database_comment]-- 数据库注释信息  [LOCATION hdfs_path] -- 内部表数据存储路径 在hive4.0版本一下内外部表都用此命令">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive基本语法">
<meta property="og:url" content="https://hackertaizi.github.io/Hadoop/Hive/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E8%AF%AD%E6%B3%95/index.html">
<meta property="og:site_name" content="太子的个人博客">
<meta property="og:description" content="Hive 基本语法一、DDL1. 数据库操作1.1 创建数据库语法格式： 12345CREATE [REMOTE] (DATABASE|SCHEMA) [IF NOT EXISTS] database_name  [COMMENT database_comment]-- 数据库注释信息  [LOCATION hdfs_path] -- 内部表数据存储路径 在hive4.0版本一下内外部表都用此命令">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-16T05:48:25.458Z">
<meta property="article:modified_time" content="2023-09-27T10:27:55.784Z">
<meta property="article:author" content="Taizi">
<meta property="article:tag" content="大数据">
<meta property="article:tag" content="Hive">
<meta property="article:tag" content="Hadoop">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hackertaizi.github.io/Hadoop/Hive/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E8%AF%AD%E6%B3%95/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hackertaizi.github.io/Hadoop/Hive/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E8%AF%AD%E6%B3%95/","path":"Hadoop/Hive/Hive的基本使用语法/","title":"Hive基本语法"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hive基本语法 | 太子的个人博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">太子的个人博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Have a nice day !</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/categories/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hive-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">Hive 基本语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81DDL"><span class="nav-number">1.1.</span> <span class="nav-text">一、DDL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.1.</span> <span class="nav-text">1. 数据库操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">1.1 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">1.2 删除数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">1.3 修改数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-%E9%80%89%E6%8B%A9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">1.4 选择数据库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.2.</span> <span class="nav-text">2. 数据表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">2.1 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">2.2 删除表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-%E6%88%AA%E6%96%AD%E8%A1%A8%EF%BC%88%E5%88%A0%E9%99%A4%E8%A1%A8%E7%9A%84%E6%89%80%E6%9C%89%E8%A1%8C%EF%BC%8C%E5%8D%B3%E6%B8%85%E7%A9%BA%E8%A1%A8%EF%BC%89"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">2.3 截断表（删除表的所有行，即清空表）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">2.4 修改表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-1-%E9%87%8D%E5%91%BD%E5%90%8D"><span class="nav-number">1.1.2.4.1.</span> <span class="nav-text">2.4.1 重命名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-2-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.2.4.2.</span> <span class="nav-text">2.4.2 修改表属性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-3-%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%B3%A8%E9%87%8A"><span class="nav-number">1.1.2.4.3.</span> <span class="nav-text">2.4.3 修改表注释</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-4-%E6%B7%BB%E5%8A%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%87%E6%BB%A4%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.2.4.4.</span> <span class="nav-text">2.4.4 添加正则表达式过滤属性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-5-%E5%88%A0%E9%99%A4%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%87%E6%BB%A4%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.2.4.5.</span> <span class="nav-text">2.4.5 删除正则表达式过滤属性</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81DML"><span class="nav-number">1.2.</span> <span class="nav-text">二、DML</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%B0%86%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="nav-number">1.2.1.</span> <span class="nav-text">1. 将文件导入数据表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%80%9A%E8%BF%87%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E5%B0%86%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%E8%A1%A8%EF%BC%88%E5%B8%B8%E7%94%A8%EF%BC%89"><span class="nav-number">1.2.2.</span> <span class="nav-text">2. 通过查询语句将数据插入数据表（常用）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E6%99%AE%E9%80%9A%E8%A1%A8%E5%92%8C%E9%9D%99%E6%80%81%E5%88%86%E5%8C%BA%E8%A1%A8%E7%9A%84%E6%8F%92%E5%85%A5"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">2.1 普通表和静态分区表的插入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA%E8%A1%A8%E7%9A%84%E6%8F%92%E5%85%A5"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">2.2 动态分区表的插入</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%80%9A%E8%BF%87%E6%9F%A5%E8%AF%A2%E5%B0%86%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.2.3.</span> <span class="nav-text">3. 通过查询将数据写入文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E4%BD%BF%E7%94%A8SQL%E5%B0%86%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5%E8%A1%A8"><span class="nav-number">1.2.4.</span> <span class="nav-text">4. 使用SQL将数据插入表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E8%A1%A8%E6%9B%B4%E6%96%B0%EF%BC%88UPDATE%EF%BC%89"><span class="nav-number">1.2.5.</span> <span class="nav-text">5. 表更新（UPDATE）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E8%A1%A8%E5%88%A0%E9%99%A4%EF%BC%88DELETE%EF%BC%89"><span class="nav-number">1.3.</span> <span class="nav-text">6. 表删除（DELETE）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-MERGE"><span class="nav-number">1.3.1.</span> <span class="nav-text">7. MERGE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E9%9B%86%E7%BE%A4%E9%97%B4%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB-IMPORT-x2F-EXPORT%EF%BC%88%E8%BF%99%E9%83%A8%E5%88%86%E7%9F%A5%E8%AF%86%E5%BE%85%E8%A1%A5%E5%85%85%EF%BC%89"><span class="nav-number">1.3.2.</span> <span class="nav-text">8. 集群间数据迁移 IMPORT&#x2F;EXPORT（这部分知识待补充）</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Taizi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hackertaizi.github.io/Hadoop/Hive/Hive%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Taizi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="太子的个人博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hive基本语法 | 太子的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hive基本语法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-16 13:48:25" itemprop="dateCreated datePublished" datetime="2023-09-16T13:48:25+08:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-27 18:27:55" itemprop="dateModified" datetime="2023-09-27T18:27:55+08:00">2023-09-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hadoop/Hive/" itemprop="url" rel="index"><span itemprop="name">Hive</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>25 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Hive-基本语法"><a href="#Hive-基本语法" class="headerlink" title="Hive 基本语法"></a>Hive 基本语法</h1><h2 id="一、DDL"><a href="#一、DDL" class="headerlink" title="一、DDL"></a>一、DDL</h2><h3 id="1-数据库操作"><a href="#1-数据库操作" class="headerlink" title="1. 数据库操作"></a>1. 数据库操作</h3><h4 id="1-1-创建数据库"><a href="#1-1-创建数据库" class="headerlink" title="1.1 创建数据库"></a>1.1 创建数据库</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [REMOTE] (DATABASE<span class="operator">|</span>SCHEMA) [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name</span><br><span class="line">  [COMMENT database_comment]<span class="comment">-- 数据库注释信息</span></span><br><span class="line">  [LOCATION hdfs_path] <span class="comment">-- 内部表数据存储路径 在hive4.0版本一下内外部表都用此命令设置存储路径</span></span><br><span class="line">  [MANAGEDLOCATION hdfs_path] <span class="comment">-- 外部表存储路径 hive4.0版本后可用</span></span><br><span class="line">  [<span class="keyword">WITH</span> DBPROPERTIES (property_name<span class="operator">=</span>property_value, ...)]; <span class="comment">-- 指派自定义属性</span></span><br></pre></td></tr></table></figure>

<p><strong>自己指定的的位置的话,在hdfs上面生成的数据库路径文件夹是没有.db,使用默认路径生成的数据库路径文件夹有.db</strong></p>
<p>具体实例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> shopping</span><br><span class="line">COMMENT `stores <span class="keyword">all</span> shopping basket data`</span><br><span class="line">LOCATION `<span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>retail<span class="operator">/</span>hive<span class="operator">/</span>SHOPPING.db`</span><br><span class="line"><span class="keyword">WITH</span> PROPERTIES (<span class="string">&#x27;purpose&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;testing&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="1-2-删除数据库"><a href="#1-2-删除数据库" class="headerlink" title="1.2 删除数据库"></a>1.2 删除数据库</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> (DATABASE<span class="operator">|</span>SCHEMA) [IF <span class="keyword">EXISTS</span>] database_name [RESTRICT<span class="operator">|</span>CASCADE];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>若选择RESTRICT，该表的删除是有限制条件的。该表不能被其他表的约束所引用（如CHECK，FOREIGN KEY等约束），不能有触发器，不能有视图，不能有函数和存储过程等。如果该表存在这些依赖的对象，此表不能删除。	</p>
<p>若选择CASCADE，该表的删除没有限制条件。在删除基本表的同时，相关的依赖对象将会被一起删除。<br>​</p>
<p>默认是RESTRICT</p>
</blockquote>
<h4 id="1-3-修改数据库"><a href="#1-3-修改数据库" class="headerlink" title="1.3 修改数据库"></a>1.3 修改数据库</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> DBPROPERTIES (property_name<span class="operator">=</span>property_value, ...);   <span class="comment">-- (<span class="doctag">Note:</span> SCHEMA added in Hive 0.14.0) 修改元数据属性</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> OWNER [<span class="keyword">USER</span><span class="operator">|</span>ROLE] user_or_role;   <span class="comment">-- (<span class="doctag">Note:</span> Hive 0.13.0 and later; SCHEMA added in Hive 0.14.0) 修改所有者</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> LOCATION hdfs_path; <span class="comment">-- (<span class="doctag">Note:</span> Hive 2.2.1, 2.4.0 and later) 修改数据存储路径</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> MANAGEDLOCATION hdfs_path; <span class="comment">-- (<span class="doctag">Note:</span> Hive 4.0.0 and later) </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>DATABASE|SCHEMA (数据库|架构)，创建时二选一即可，这里它们是同义的。</p>
</blockquote>
<h4 id="1-4-选择数据库"><a href="#1-4-选择数据库" class="headerlink" title="1.4 选择数据库"></a>1.4 选择数据库</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE database_name;</span><br><span class="line">USE <span class="keyword">DEFAULT</span>;</span><br></pre></td></tr></table></figure>



<h3 id="2-数据表操作"><a href="#2-数据表操作" class="headerlink" title="2. 数据表操作"></a>2. 数据表操作</h3><h4 id="2-1-创建表"><a href="#2-1-创建表" class="headerlink" title="2.1 创建表"></a>2.1 创建表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [db_name.]table_name    <span class="comment">-- (<span class="doctag">Note:</span> TEMPORARY available in Hive 0.14.0 and later)</span></span><br><span class="line">  [(col_name data_type [column_constraint_specification] [COMMENT col_comment], ... [constraint_specification])]</span><br><span class="line">  [COMMENT table_comment]</span><br><span class="line">  [PARTITIONED <span class="keyword">BY</span> (col_name data_type [COMMENT col_comment], ...)]</span><br><span class="line">  [CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) [SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...)] </span><br><span class="line">   <span class="keyword">INTO</span> num_buckets BUCKETS]</span><br><span class="line">  [SKEWED <span class="keyword">BY</span> (col_name, col_name, ...) ]<span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.10.0 and later)</span></span><br><span class="line">   <span class="keyword">ON</span> ((col_value, col_value, ...), (col_value, col_value, ...), ...) </span><br><span class="line">  [STORED <span class="keyword">AS</span> DIRECTORIES]</span><br><span class="line">  [</span><br><span class="line">   [<span class="type">ROW</span> FORMAT row_format] </span><br><span class="line">   [STORED <span class="keyword">AS</span> file_format]</span><br><span class="line">     <span class="operator">|</span> STORED <span class="keyword">BY</span> <span class="string">&#x27;storage.handler.class.name&#x27;</span> [<span class="keyword">WITH</span> SERDEPROPERTIES (...)]  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.6.0 and later)</span></span><br><span class="line">  ]</span><br><span class="line">  [LOCATION hdfs_path]</span><br><span class="line">  [TBLPROPERTIES (property_name<span class="operator">=</span>property_value, ...)]   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.6.0 and later)</span></span><br><span class="line">  [<span class="keyword">AS</span> select_statement];   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.5.0 and later; not supported for external tables)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [db_name.]table_name</span><br><span class="line">  <span class="keyword">LIKE</span> existing_table_or_view_name</span><br><span class="line">  [LOCATION hdfs_path];</span><br><span class="line"> </span><br><span class="line">data_type</span><br><span class="line">  : primitive_type</span><br><span class="line">  <span class="operator">|</span> array_type</span><br><span class="line">  <span class="operator">|</span> map_type</span><br><span class="line">  <span class="operator">|</span> struct_type</span><br><span class="line">  <span class="operator">|</span> union_type  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.7.0 and later)</span></span><br><span class="line"> </span><br><span class="line">primitive_type</span><br><span class="line">  : TINYINT</span><br><span class="line">  <span class="operator">|</span> <span class="type">SMALLINT</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">INT</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">BIGINT</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">BOOLEAN</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">FLOAT</span></span><br><span class="line">  <span class="operator">|</span> <span class="keyword">DOUBLE</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">DOUBLE PRECISION</span> <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 2.2.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> STRING</span><br><span class="line">  <span class="operator">|</span> <span class="type">BINARY</span>      <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.8.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">TIMESTAMP</span>   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.8.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">DECIMAL</span>     <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.11.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">DECIMAL</span>(<span class="keyword">precision</span>, scale)  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.13.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">DATE</span>        <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.12.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">VARCHAR</span>     <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.12.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> <span class="type">CHAR</span>        <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.13.0 and later)</span></span><br><span class="line"> </span><br><span class="line">array_type</span><br><span class="line">  : <span class="keyword">ARRAY</span> <span class="operator">&lt;</span> data_type <span class="operator">&gt;</span></span><br><span class="line"> </span><br><span class="line">map_type</span><br><span class="line">  : MAP <span class="operator">&lt;</span> primitive_type, data_type <span class="operator">&gt;</span></span><br><span class="line"> </span><br><span class="line">struct_type</span><br><span class="line">  : STRUCT <span class="operator">&lt;</span> col_name : data_type [COMMENT col_comment], ...<span class="operator">&gt;</span></span><br><span class="line"> </span><br><span class="line">union_type</span><br><span class="line">   : UNIONTYPE <span class="operator">&lt;</span> data_type, data_type, ... <span class="operator">&gt;</span>  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.7.0 and later)</span></span><br><span class="line"> </span><br><span class="line">row_format</span><br><span class="line">  : DELIMITED [FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span> [ESCAPED <span class="keyword">BY</span> <span class="type">char</span>]] [COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">        [MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] [LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">        [<span class="keyword">NULL</span> DEFINED <span class="keyword">AS</span> <span class="type">char</span>]   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.13 and later)</span></span><br><span class="line">  <span class="operator">|</span> SERDE serde_name [<span class="keyword">WITH</span> SERDEPROPERTIES (property_name<span class="operator">=</span>property_value, property_name<span class="operator">=</span>property_value, ...)]</span><br><span class="line"> </span><br><span class="line">file_format:</span><br><span class="line">  : SEQUENCEFILE</span><br><span class="line">  <span class="operator">|</span> TEXTFILE    <span class="comment">-- (Default, depending on hive.default.fileformat configuration)</span></span><br><span class="line">  <span class="operator">|</span> RCFILE      <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.6.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> ORC         <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.11.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> PARQUET     <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.13.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> AVRO        <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.14.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> JSONFILE    <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 4.0.0 and later)</span></span><br><span class="line">  <span class="operator">|</span> INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname</span><br><span class="line"> </span><br><span class="line">column_constraint_specification:</span><br><span class="line">  : [ <span class="keyword">PRIMARY</span> KEY<span class="operator">|</span><span class="keyword">UNIQUE</span><span class="operator">|</span><span class="keyword">NOT</span> <span class="keyword">NULL</span><span class="operator">|</span><span class="keyword">DEFAULT</span> [default_value]<span class="operator">|</span><span class="keyword">CHECK</span>  [check_expression] ENABLE<span class="operator">|</span>DISABLE NOVALIDATE RELY<span class="operator">/</span>NORELY ]</span><br><span class="line"> </span><br><span class="line">default_value:</span><br><span class="line">  : [ LITERAL<span class="operator">|</span><span class="built_in">CURRENT_USER</span>()<span class="operator">|</span><span class="built_in">CURRENT_DATE</span>()<span class="operator">|</span><span class="built_in">CURRENT_TIMESTAMP</span>()<span class="operator">|</span><span class="keyword">NULL</span> ] </span><br><span class="line"> </span><br><span class="line">constraint_specification:</span><br><span class="line">  : [, <span class="keyword">PRIMARY</span> KEY (col_name, ...) DISABLE NOVALIDATE RELY<span class="operator">/</span>NORELY ]</span><br><span class="line">    [, <span class="keyword">PRIMARY</span> KEY (col_name, ...) DISABLE NOVALIDATE RELY<span class="operator">/</span>NORELY ]</span><br><span class="line">    [, <span class="keyword">CONSTRAINT</span> constraint_name <span class="keyword">FOREIGN</span> KEY (col_name, ...) <span class="keyword">REFERENCES</span> table_name(col_name, ...) DISABLE NOVALIDATE </span><br><span class="line">    [, <span class="keyword">CONSTRAINT</span> constraint_name <span class="keyword">UNIQUE</span> (col_name, ...) DISABLE NOVALIDATE RELY<span class="operator">/</span>NORELY ]</span><br><span class="line">    [, <span class="keyword">CONSTRAINT</span> constraint_name <span class="keyword">CHECK</span> [check_expression] ENABLE<span class="operator">|</span>DISABLE NOVALIDATE RELY<span class="operator">/</span>NORELY ]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>对几个关键点说明</strong><br>a) temporary 创建临时表，只在本次回话生效<br>b) external关键字，加上这个关键字建的表是外部表，不加这个关键字建的表就是内部表<br>    内部表和外部表的区别：<br>    (1）概念本质上<br>    内部表数据自己的管理的在进行表删除时数据和元数据一并删除。<br>    外部表只是对HDFS的一个目录的数据进行关联，外部表在进行删除时只删除元数据，原始数据是不会被删除的。<br>    (2）应用场景上<br>    外部表一般用于存储原始数据、公共数据，内部表一般用于存储某一个模块的中间结果数据。<br>    (3）存储目录上<br>    外部表：一般在进行建表时候需要手动指定表的数据目录为共享资源目录，用lication关键字指定。<br>    内部表：无严格的要求，一般使用的默认目录。<br>c) partitioned by 指定分区字段<br>    partitioned by（分区字段名 分区字段类型 COMMENT 字段描述信息）<br>    注意：分区字段一定不能存在于建表字段中。<br>d) [row format row_format] 指定分割符的<br>    fields terminated by 列分割符<br>    lines terminated by 行分割符<br>    map keys terminated by<br>e) [stored as AS file_format] 指定原始数据的存储格式<br>    textfile 文本格式 默认的方式<br>    cfile 行列格式， 在行的方向切分数据的存储的块 保证一行数据在一个数据块中，每列个块中存储的时候 进行划分存储的。<br>    SequenceFile 二进制存储格式</p>
</blockquote>
<h4 id="2-2-删除表"><a href="#2-2-删除表" class="headerlink" title="2.2 删除表"></a>2.2 删除表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] table_name [PURGE];     <span class="comment">-- (<span class="doctag">Note:</span> PURGE available in Hive 0.14.0 and later)</span></span><br></pre></td></tr></table></figure>

<h4 id="2-3-截断表（删除表的所有行，即清空表）"><a href="#2-3-截断表（删除表的所有行，即清空表）" class="headerlink" title="2.3 截断表（删除表的所有行，即清空表）"></a>2.3 截断表（删除表的所有行，即清空表）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> [<span class="keyword">TABLE</span>] table_name [<span class="keyword">PARTITION</span> partition_spec];</span><br><span class="line"> </span><br><span class="line">partition_spec:</span><br><span class="line">  : (partition_column <span class="operator">=</span> partition_col_value, partition_column <span class="operator">=</span> partition_col_value, ...)</span><br></pre></td></tr></table></figure>

<h4 id="2-4-修改表"><a href="#2-4-修改表" class="headerlink" title="2.4 修改表"></a>2.4 修改表</h4><h5 id="2-4-1-重命名"><a href="#2-4-1-重命名" class="headerlink" title="2.4.1 重命名"></a>2.4.1 重命名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name RENAME <span class="keyword">TO</span> new_table_name;</span><br></pre></td></tr></table></figure>

<h5 id="2-4-2-修改表属性"><a href="#2-4-2-修改表属性" class="headerlink" title="2.4.2 修改表属性"></a>2.4.2 修改表属性</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">SET</span> TBLPROPERTIES table_properties;</span><br><span class="line"> </span><br><span class="line">table_properties:</span><br><span class="line">  : (property_name <span class="operator">=</span> property_value, property_name <span class="operator">=</span> property_value, ... )</span><br></pre></td></tr></table></figure>

<h5 id="2-4-3-修改表注释"><a href="#2-4-3-修改表注释" class="headerlink" title="2.4.3 修改表注释"></a>2.4.3 修改表注释</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">SET</span> TBLPROPERTIES (<span class="string">&#x27;comment&#x27;</span> <span class="operator">=</span> new_comment);</span><br></pre></td></tr></table></figure>

<h5 id="2-4-4-添加正则表达式过滤属性"><a href="#2-4-4-添加正则表达式过滤属性" class="headerlink" title="2.4.4 添加正则表达式过滤属性"></a>2.4.4 添加正则表达式过滤属性</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name [<span class="keyword">PARTITION</span> partition_spec] <span class="keyword">SET</span> SERDE serde_class_name [<span class="keyword">WITH</span> SERDEPROPERTIES serde_properties];</span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name [<span class="keyword">PARTITION</span> partition_spec] <span class="keyword">SET</span> SERDEPROPERTIES serde_properties;</span><br><span class="line"> </span><br><span class="line">serde_properties:</span><br><span class="line">  : (property_name <span class="operator">=</span> property_value, property_name <span class="operator">=</span> property_value, ... )</span><br></pre></td></tr></table></figure>

<h5 id="2-4-5-删除正则表达式过滤属性"><a href="#2-4-5-删除正则表达式过滤属性" class="headerlink" title="2.4.5 删除正则表达式过滤属性"></a>2.4.5 删除正则表达式过滤属性</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name [<span class="keyword">PARTITION</span> partition_spec] UNSET SERDEPROPERTIES (property_name, ... );</span><br></pre></td></tr></table></figure>



<h2 id="二、DML"><a href="#二、DML" class="headerlink" title="二、DML"></a>二、DML</h2><h3 id="1-将文件导入数据表"><a href="#1-将文件导入数据表" class="headerlink" title="1. 将文件导入数据表"></a>1. 将文件导入数据表</h3><p>语法格式:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA [<span class="keyword">LOCAL</span>] INPATH <span class="string">&#x27;filepath&#x27;</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)]</span><br><span class="line"> </span><br><span class="line">LOAD DATA [<span class="keyword">LOCAL</span>] INPATH <span class="string">&#x27;filepath&#x27;</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)] [INPUTFORMAT <span class="string">&#x27;inputformat&#x27;</span> SERDE <span class="string">&#x27;serde&#x27;</span>] (<span class="number">3.0</span> <span class="keyword">or</span> later)</span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li><p>LOAD DATA ：数据导入关键字</p>
</li>
<li><p>关于LOCAL关键字</p>
</li>
</ul>
<blockquote>
<p>LOCAL 关键字：如果指定了 LOCAL， LOAD 命令会去查找本地文件系统中的 filepath。如果没有指定 LOCAL 关键字，则根据 inpath 中的 uri 查找文件。<br>注意：uri 是指 hdfs 上的路径，分简单模式和完整模式两种，例如：</p>
<ul>
<li>简单模式：&#x2F;user&#x2F;hive&#x2F;project&#x2F;data1</li>
<li>完整模式：hdfs:&#x2F;&#x2F;namenode_host:9000&#x2F;user&#x2F;hive&#x2F;project&#x2F;data1</li>
</ul>
</blockquote>
<ul>
<li>关于文件路径 filepath</li>
</ul>
<blockquote>
<p>在hive3.0之前，文件导入操作是通过单纯的复制&#x2F;移动的方式来将数据文件导入路径下的数据表中，其中，文件路径可以是以下几种形式：</p>
<ul>
<li><p>相对路径，如<code>project/data1</code></p>
</li>
<li><p>绝对路径，如<code>/user/hive/project/data1</code></p>
</li>
<li><p>带有模式和权限(可选)的完整URI，如<code>hdfs://namenode:9000/user/hive/project/data1</code></p>
</li>
</ul>
<p>文件路径可以具体到某个要导入的文件，也可以是某个目录(文件夹)，如果是目录，hive会将目录下的所有文件导入表中。</p>
</blockquote>
<ul>
<li>关于导入表的类型</li>
</ul>
<blockquote>
<p>接收导入数据的表可以是一个已有表或者分区表，如果表是分区表，则必须指定分区字段内所有属性(列)的值。也可以使用 </p>
<p>CREATE TABLE 在导入时创建导入表。</p>
</blockquote>
<ul>
<li>输入格式控制(Hive 3.0之后可用)</li>
</ul>
<blockquote>
<p>输入格式(inputformat)可以是hive 的任何输入格式，如text、ORC等。</p>
<p>serde可以是关联的配置单元serde。</p>
<p>inputformat和serde都区分大小写</p>
</blockquote>
<ul>
<li>其他加载操作</li>
</ul>
<blockquote>
<p>Hive 3.0及更高版本中，除了移动复制操作之外，还支持其他加载操作，因为Hive在内部在某些场合下会将加载重写为<strong>INSERT AS SELECT</strong>。<br>比如，如果表具有分区，而load命令没有指定分区，则将load转换为INSERT AS SELECT，并假定最后一组列为分区列。如果文件不符合预期的架构，它将引发错误。</p>
</blockquote>
<p>注意：</p>
<ul>
<li><p>文件路径下不能包含有子目录，即如果指定的文件路径是一个目录，该目录下不能包含子目录。</p>
</li>
<li><p>如果没有指定LOCAL关键字，则导入的文件必须与表在同一个文件系统下</p>
</li>
</ul>
<h3 id="2-通过查询语句将数据插入数据表（常用）"><a href="#2-通过查询语句将数据插入数据表（常用）" class="headerlink" title="2. 通过查询语句将数据插入数据表（常用）"></a>2. 通过查询语句将数据插入数据表（常用）</h3><h4 id="2-1-普通表和静态分区表的插入"><a href="#2-1-普通表和静态分区表的插入" class="headerlink" title="2.1 普通表和静态分区表的插入"></a>2.1 普通表和静态分区表的插入</h4><p>使用这种方式可以将查询结果插入数据表。</p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Standard syntax:<span class="comment">-- 标准语法格式</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...) [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>]] select_statement1 <span class="keyword">FROM</span> from_statement;<span class="comment">-- 覆盖插入</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)] select_statement1 <span class="keyword">FROM</span> from_statement; <span class="comment">-- 增量插入</span></span><br><span class="line"> </span><br><span class="line">Hive extension (multiple inserts):<span class="comment">-- hive拓展，多表插入</span></span><br><span class="line"><span class="keyword">FROM</span> from_statement</span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...) [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>]] select_statement1</span><br><span class="line">[<span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename2 [<span class="keyword">PARTITION</span> ... [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>]] select_statement2]</span><br><span class="line">[<span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename2 [<span class="keyword">PARTITION</span> ...] select_statement2] ...;</span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> from_statement</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)] select_statement1</span><br><span class="line">[<span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename2 [<span class="keyword">PARTITION</span> ...] select_statement2]</span><br><span class="line">[<span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename2 [<span class="keyword">PARTITION</span> ... [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>]] select_statement2] ...;</span><br><span class="line"> </span><br><span class="line">Hive extension (<span class="keyword">dynamic</span> <span class="keyword">partition</span> inserts): <span class="comment">-- hive拓展，动态分区插入</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename <span class="keyword">PARTITION</span> (partcol1[<span class="operator">=</span>val1], partcol2[<span class="operator">=</span>val2] ...) select_statement <span class="keyword">FROM</span> from_statement;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename <span class="keyword">PARTITION</span> (partcol1[<span class="operator">=</span>val1], partcol2[<span class="operator">=</span>val2] ...) select_statement <span class="keyword">FROM</span> from_statement;</span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li>两种插入方式概述</li>
</ul>
<blockquote>
<p>INSERT OVERWRITE 方式插入数据会将表或者分区表中的信息清空覆盖，具体实现是先查找到要插入的数据，然后将表清空，最后插入数据</p>
<p>INSERT INTO 方式插入数据会在表或者分区表中添加增量信息，即不改变表中的原有数据，而是在后面添加。</p>
<p>在Hive 0.13.0之后，创建数据表时可以指定表属性TBLPROPERTIES(“immutable”&#x3D;”true”)，(immutable默认为false),这样表就是不可变的，如果一个不可变的表上有任何数据的话，INSERT INTO 方式插入数据不能在不可变的表上操作。但如果不可变的表是空的，则仍然可以通过INSERT INTO 方式插入数据。INSERT OVERWRITE 插入方式不受表的immutable属性限制。</p>
</blockquote>
<ul>
<li>IF NOT EXISTS 关键字</li>
</ul>
<blockquote>
<p>如果使用了该关键字，当数据插入时如果表不存在，会创建一个表；如果没有使用改关键字，当数据插入时如果表不存在，指令会执行失败。</p>
</blockquote>
<ul>
<li>分区表插入注意事项</li>
</ul>
<blockquote>
<p>可以向表或者分区表中插入数据，如果是分区表，插入时则必须指定所有分区字段的值，如果<code>hive.typecheck.on.insert</code>被设置为true,则hive会校验、转化、规范化这些值使它们符合列的类型。(Hive 0.12.0以后)</p>
</blockquote>
<ul>
<li>多表插入</li>
</ul>
<blockquote>
<p>多表插入的意思是可以在一个查询中指定多个INSERT语句，只需要扫描一遍源表。如果要使用覆盖的方法插入，OVERWRITE关键字是必须的，不是可选的。多表插入可最大限度地减少所需的数据扫描次数。Hive只需扫描输入数据一次（并对输入数据应用不同的查询运算符），即可将数据插入多个表中。</p>
<p><strong>多表插入时，如果目标表是普通表，则不能插入相同的表。</strong></p>
<p><strong>多表插入时，如果目标表是分区表，则插入的表不能是相同表的相同分区，可以是相同表的不通分区。</strong></p>
</blockquote>
<ul>
<li>输出格式</li>
</ul>
<blockquote>
<p>输出格式由表的元数据定义。</p>
</blockquote>
<blockquote>
<p>自Hive 0.14起，如果一个表的OutputFormat实现了AcidOutputFormat，并且系统配置为使用实现ACID的事务管理器，则该表的插入覆盖将被禁用。这是为了避免用户无意中覆盖事务历史记录。同样的功能也可以通过使用TRUNCATE TABLE（对于非分区表）或DROP PARTITION，然后INSERT INTO来实现。</p>
</blockquote>
<ul>
<li>其他</li>
</ul>
<blockquote>
<p>自Hive1.1.0开始，关键字TABLE 变成了可选的而不是必需的。</p>
</blockquote>
<blockquote>
<p>自Hive3.1.0起，不允许从数据源中使用UNION ALL对完整CRUD ACID表进行插入覆盖。</p>
</blockquote>
<h4 id="2-2-动态分区表的插入"><a href="#2-2-动态分区表的插入" class="headerlink" title="2.2 动态分区表的插入"></a>2.2 动态分区表的插入</h4><p>动态分区表插入时，动态分区列必须在select语句的最后进行指定，且指定顺序必须与partition中指定的先后顺序相同。从Hive3.0.0起，不需要指定动态分区列。</p>
<p>在Hive0.9.0之前，动态分区是默认不可用的，在Hive0.9.0之后，动态分区是默认可用的，以下是有关动态分区表的插入的一些属性配置：</p>
<table>
<thead>
<tr>
<th>配置属性</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>hive.exec.dynamic.partition</td>
<td>true</td>
<td>当动态分区表插入时需要被设置为true</td>
</tr>
<tr>
<td>hive.exec.dynamic.partition.mode</td>
<td>strict</td>
<td>在严格模式下，使用者必须确定至少一个静态分区来防止所有分区被意外覆盖，而在非严格模式下，所有分区都可以是动态的。</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions.pernode</td>
<td>100</td>
<td>在一个mapper&#x2F;reducer节点中允许创建的最大动态分区数</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions</td>
<td>1000</td>
<td>允许创建的最大动态分区总数</td>
</tr>
<tr>
<td>hive.exec.max.created.files</td>
<td>100000</td>
<td>在一个MapReduce任务中所有mappers&#x2F;reducers可以创建的最大HDFS文件数量总数</td>
</tr>
<tr>
<td>hive.error.on.empty.partition</td>
<td>false</td>
<td>如果动态分区插入结果为空是否抛出异常</td>
</tr>
</tbody></table>
<h3 id="3-通过查询将数据写入文件系统"><a href="#3-通过查询将数据写入文件系统" class="headerlink" title="3. 通过查询将数据写入文件系统"></a>3. 通过查询将数据写入文件系统</h3><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Standard syntax: <span class="comment">-- 标准语法</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE [<span class="keyword">LOCAL</span>] DIRECTORY directory1</span><br><span class="line">  [<span class="type">ROW</span> FORMAT row_format] [STORED <span class="keyword">AS</span> file_format] (Note: <span class="keyword">Only</span> available starting <span class="keyword">with</span> Hive <span class="number">0.11</span><span class="number">.0</span>)</span><br><span class="line">  <span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> ...</span><br><span class="line"> </span><br><span class="line">Hive extension (multiple inserts): <span class="comment">-- hive拓展，多插入</span></span><br><span class="line"><span class="keyword">FROM</span> from_statement</span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE [<span class="keyword">LOCAL</span>] DIRECTORY directory1 select_statement1</span><br><span class="line">[<span class="keyword">INSERT</span> OVERWRITE [<span class="keyword">LOCAL</span>] DIRECTORY directory2 select_statement2] ...</span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line">row_format</span><br><span class="line">  : DELIMITED [FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span> [ESCAPED <span class="keyword">BY</span> <span class="type">char</span>]] [COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">        [MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] [LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">        [<span class="keyword">NULL</span> DEFINED <span class="keyword">AS</span> <span class="type">char</span>] (Note: <span class="keyword">Only</span> available starting <span class="keyword">with</span> Hive <span class="number">0.13</span>)</span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li>INSERT OVERWRITE :插入语法关键字</li>
<li>LOCAL关键字</li>
</ul>
<blockquote>
<p>LOCAL 关键字：如果指定了 LOCAL， Hive会将数据写入到本次文件系统中。如果没有指定 LOCAL 关键字，则根据 DIRECTORY 中的 uri 查找文件。<br>注意：uri 是指 hdfs 上的路径，分简单模式和完整模式两种，例如：</p>
<ul>
<li>简单模式：&#x2F;user&#x2F;hive&#x2F;project&#x2F;data1</li>
<li>完整模式：hdfs:&#x2F;&#x2F;namenode_host:9000&#x2F;user&#x2F;hive&#x2F;project&#x2F;data1</li>
</ul>
</blockquote>
<ul>
<li>DIRECTORY 要写入的文件目录</li>
</ul>
<blockquote>
<p>目录可以是一个完整的URI，当标识和权限不确定时，Hive将会从hadoop配置变量fs.default.name中确定URI。</p>
</blockquote>
<ul>
<li>写入格式</li>
</ul>
<blockquote>
<p>数据在写入文件系统时会被序列化成text文本，列之间使用<code>^A</code>分隔符分隔，行之间使用换行分隔，如果任何列不是基本类型，那么这些列将会被序列化为JSON格式。</p>
</blockquote>
<ul>
<li>注意</li>
</ul>
<blockquote>
<p>INSERT OVERWRITE语句写入目录、本地目录，表（或分区表）可以写在一个查询中。</p>
<p>当有大量数据时，使用Hive将数据写入HDFS文件系统的目录中是最好的处理方式，因为Hive可以在一个MapReduce中将数据并行地写入HDFS目录中。</p>
<p>指定的目录如果存在，则写入操作会将目录中原来的数据覆盖，即会先将原有的数据删除，然后插入查询到的数据。</p>
<p>从Hive 0.11.0开始，可以指定使用的分隔符；在早期版本中，它始终是^A字符（\ 001）。但是，在Hive0.11.0至1.1.0中，仅支持自定义分隔符用于本地写入–此错误在版本1.2.0中得到修复。</p>
<p>在Hive 0.14中，插入到符合ACID的表中将在选择和插入期间停用矢量化。这将自动完成。插入数据的ACID表仍然可以使用矢量化进行查询。</p>
</blockquote>
<h3 id="4-使用SQL将数据插入表"><a href="#4-使用SQL将数据插入表" class="headerlink" title="4. 使用SQL将数据插入表"></a>4. 使用SQL将数据插入表</h3><p>使用INSERT……VALUES 通过SQL可以直接将数据插入表。</p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Standard Syntax: <span class="comment">-- 标准语法</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1[<span class="operator">=</span>val1], partcol2[<span class="operator">=</span>val2] ...)] <span class="keyword">VALUES</span> values_row [, values_row ...]</span><br><span class="line">  </span><br><span class="line"><span class="keyword">Where</span> values_row <span class="keyword">is</span>:</span><br><span class="line">( <span class="keyword">value</span> [, <span class="keyword">value</span> ...] )</span><br><span class="line"><span class="keyword">where</span> a <span class="keyword">value</span> <span class="keyword">is</span> either <span class="keyword">null</span> <span class="keyword">or</span> <span class="keyword">any</span> valid <span class="keyword">SQL</span> literal<span class="comment">-- 值可以是null或有效的SQL语句</span></span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li><p>VALUES子句中列出的每一行都会插入到tablename表中。 </p>
</li>
<li><p>VALUES字句必须提供表中的所有列的值，不允许只提供某些列的值，为了模拟标注sql，使用者可以用null填充那些不需要赋值的列。</p>
</li>
<li><p>动态分区表的插入方式同<code>INSERT...SELECT </code>语法一样。</p>
</li>
<li><p>如果插入到的表支持ACID，并且正在使用支持ACID的事务管理器，则此操作将在成功完成后自动提交。 </p>
</li>
<li><p><strong>Hive不支持复杂类型(array, map, struct, union)文本，所以在INSERT……VALUES也不支持这些复杂类型，这意味着使用者不能通过INSERT……VALUES将数据插入复杂类型的列中。</strong></p>
</li>
</ul>
<h3 id="5-表更新（UPDATE）"><a href="#5-表更新（UPDATE）" class="headerlink" title="5. 表更新（UPDATE）"></a>5. 表更新（UPDATE）</h3><p>UPDATE语法在Hive0.14开始使用。</p>
<p><strong>UPDATE只能在支持ACID的表中使用。</strong></p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Standard Syntax:</span><br><span class="line"><span class="keyword">UPDATE</span> tablename <span class="keyword">SET</span> <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span> [, <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span> ...] [<span class="keyword">WHERE</span> expression]</span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li>引用的列必须是要更新的表的列。</li>
<li>分配的值必须是Hive select子句中支持的表达式。因此，支持算术运算符、UDF、强制转换、文字等。不支持子查询。</li>
<li>分区列和分桶列不能被更新。</li>
<li>在Hive0.14 中，操作成功后更改会自动提交。</li>
</ul>
<p>注意：</p>
<ul>
<li>更新操作会关闭矢量化，这是自动执行的，不需要使用者下发指令。没更新过的表不会收影响，更新后的表也仍然可以使用矢量化查询。</li>
<li>在0.14 版本,更新时建议配置 <code>hive.optimize.sort.dynamic.partition = fasle</code>,因为会更高效。</li>
</ul>
<h2 id="6-表删除（DELETE）"><a href="#6-表删除（DELETE）" class="headerlink" title="6. 表删除（DELETE）"></a>6. 表删除（DELETE）</h2><p>DELETE语法在Hive0.14开始使用。</p>
<p><strong>DELETE只能在支持ACID的表中使用。</strong></p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Standard Syntax:</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tablename [<span class="keyword">WHERE</span> expression]</span><br></pre></td></tr></table></figure>

<p>注意:</p>
<ul>
<li><p>在Hive0.14 中，操作成功后更改会自动提交。</p>
</li>
<li><p>删除操作会关闭矢量化，这是自动执行的，不需要使用者下发指令。没删除过的表不会收影响，删除操作完成后的表也仍然可以使用矢量化查询。</p>
</li>
<li><p>在0.14 版本,删除时建议配置 <code>hive.optimize.sort.dynamic.partition = fasle</code>,因为会更高效。</p>
</li>
</ul>
<h3 id="7-MERGE"><a href="#7-MERGE" class="headerlink" title="7. MERGE"></a>7. MERGE</h3><p>Merge简介：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MERGE语句是SQL语句的一种。在SQL Server、Oracle数据库中可用，MySQL、PostgreSQL中不可用。MERGE是Oracle9i新增的语法，用来合并UPDATE和INSERT语句。通过MERGE语句，根据一张表（原数据表，source table）或子查询的连接条件对另外一张（目标表，target table）表进行查询，连接条件匹配上的进行UPDATE，无法匹配的执行INSERT。这个语法仅需要一次全表扫描就完成了全部工作，执行效率要高于INSERT+UPDATE。</span><br></pre></td></tr></table></figure>

<p>版本信息：</p>
<ul>
<li>MERGE在Hive 2.2中开始使用。</li>
<li><strong>MERGE只能在支持ACID的表中使用。</strong></li>
</ul>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Standard Syntax:</span><br><span class="line"><span class="keyword">MERGE</span> <span class="keyword">INTO</span> <span class="operator">&lt;</span>target <span class="keyword">table</span><span class="operator">&gt;</span> <span class="keyword">AS</span> T <span class="keyword">USING</span> <span class="operator">&lt;</span>source expression<span class="operator">/</span><span class="keyword">table</span><span class="operator">&gt;</span> <span class="keyword">AS</span> S</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span><span class="type">boolean</span> expression1<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHEN</span> MATCHED [<span class="keyword">AND</span> <span class="operator">&lt;</span><span class="type">boolean</span> expression2<span class="operator">&gt;</span>] <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> <span class="keyword">SET</span> <span class="operator">&lt;</span><span class="keyword">set</span> clause list<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHEN</span> MATCHED [<span class="keyword">AND</span> <span class="operator">&lt;</span><span class="type">boolean</span> expression3<span class="operator">&gt;</span>] <span class="keyword">THEN</span> <span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED [<span class="keyword">AND</span> <span class="operator">&lt;</span><span class="type">boolean</span> expression4<span class="operator">&gt;</span>] <span class="keyword">THEN</span> <span class="keyword">INSERT</span> <span class="keyword">VALUES</span><span class="operator">&lt;</span><span class="keyword">value</span> list<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<p>语法解析：</p>
<ul>
<li><p>Merge允许基于与源表的联接结果对目标表执行操作。</p>
</li>
<li><p>自Hive2.2起，merge操作成功后会自动提交事务。</p>
</li>
</ul>
<p>注意：</p>
<ul>
<li>WHEN条件子句中，INSERT&#x2F;UPDATE&#x2F;DELETE中的每个语句最多只有一个，例如不能同时有两个insert子句。</li>
<li>WHEN NOT MATCHED必须放在多个WHEN子句的最后。</li>
<li>如果同时存在UPDATE和DELETE子句，则放在前面的哪一个字句中必须包含<code>AND &lt;boolean expression&gt;</code></li>
</ul>
<p>t条件。</p>
<ul>
<li>Merge操作会关闭矢量化，这是自动执行的，不需要使用者下发指令。没Merge过的表不会收影响，Merge操作完成后的表也仍然可以使用矢量化查询。</li>
</ul>
<h3 id="8-集群间数据迁移-IMPORT-x2F-EXPORT（这部分知识待补充）"><a href="#8-集群间数据迁移-IMPORT-x2F-EXPORT（这部分知识待补充）" class="headerlink" title="8. 集群间数据迁移 IMPORT&#x2F;EXPORT（这部分知识待补充）"></a>8. 集群间数据迁移 IMPORT&#x2F;EXPORT（这部分知识待补充）</h3><p>版本信息：</p>
<p>IMPORT&#x2F;EXPORT命令在Hive 0.8.0版本添加。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag"># 大数据</a>
              <a href="/tags/Hive/" rel="tag"># Hive</a>
              <a href="/tags/Hadoop/" rel="tag"># Hadoop</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Hadoop/Hive/Hive%E8%AF%AD%E6%B3%95%E7%B2%BE%E7%82%BC/" rel="prev" title="Hive语法精炼">
                  <i class="fa fa-angle-left"></i> Hive语法精炼
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Hadoop/Hive/Hive%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" rel="next" title="Hive文件格式">
                  Hive文件格式 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Powered by Hackertaizi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">225k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:49</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
